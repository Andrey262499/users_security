<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>User page</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            min-height: calc(100vh - 56px);
        }

        .content-wrap {
            background: #f8f9fa;
            min-height: calc(100vh - 56px);
        }
    </style>
</head>

<body>
<!-- Top bar -->
<nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
        <div class="d-flex align-items-center text-white">
            <strong th:text="${#request.userPrincipal != null ? #request.userPrincipal.name : ''}">user@mail.ru</strong>
            <span class="ms-2">with roles:</span>
            <span class="ms-2">
        <span th:if="${#request.isUserInRole('ADMIN') || #request.isUserInRole('ROLE_ADMIN')}">ADMIN</span>
        <span th:if="${#request.isUserInRole('USER') || #request.isUserInRole('ROLE_USER')}">USER</span>
      </span>
        </div>

        <form th:action="@{/logout}" method="post" class="m-0">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button type="submit" class="btn btn-link text-decoration-none text-white">Logout</button>
        </form>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <!-- Left sidebar -->
        <aside class="col-12 col-md-2 col-lg-2 p-0 bg-light border-end sidebar">
            <div class="list-group list-group-flush">
                <a th:if="${#request.isUserInRole('ADMIN') || #request.isUserInRole('ROLE_ADMIN')}"
                   th:href="@{/admin}" class="list-group-item list-group-item-action">Admin</a>
                <a th:href="@{/user}" class="list-group-item list-group-item-action active">User</a>
            </div>
        </aside>

        <!-- Main content -->
        <main class="col-12 col-md-10 col-lg-10 content-wrap p-4">
            <h1 class="display-5 fw-bold mb-3">User information-page</h1>

            <div class="card border-0">
                <div class="card-header fw-bold">About user</div>
                <div class="card-body">

                    <div th:if="${user == null}" class="alert alert-warning mb-0">
                        User not found: <b th:text="${email}"></b>
                    </div>

                    <div th:if="${user != null}" class="table-responsive">
                        <table class="table table-striped align-middle mb-0">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>First Name</th>
                                <th>Email</th>
                                <th>Role</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td th:text="${user.id}">1</td>
                                <td th:text="${user.name}">user</td>
                                <td th:text="${user.email}">user@mail.ru</td>
                                <td>
                  <span th:each="r, st : ${user.roles}"
                        th:text="${#strings.replace(r.name, 'ROLE_', '') + (st.last ? '' : ' ')}">USER</span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </main>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
